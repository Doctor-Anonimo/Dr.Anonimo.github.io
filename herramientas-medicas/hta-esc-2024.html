<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente Clínico HTA - ESC 2024</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --esc-blue: #005eb8;
            --esc-light: #f8f9fa;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f6f9;
        }
        .header-main {
            background: linear-gradient(135deg, var(--esc-blue), #003b73);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .nav-pills .nav-link.active {
            background-color: var(--esc-blue);
        }
        .nav-pills .nav-link {
            color: #333;
            font-weight: 500;
        }
        .card {
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
            border-top: 4px solid var(--esc-blue);
        }
        .card-header {
            background-color: white;
            font-weight: bold;
            color: var(--esc-blue);
            border-bottom: 1px solid #eee;
        }
        .target-box {
            background-color: #e8f4fd;
            border-left: 5px solid var(--esc-blue);
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .calc-result {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--esc-blue);
        }
        .warning-text {
            color: #dc3545;
            font-size: 0.9rem;
        }
        /* Estilos para la tabla de clasificación */
        .table-bp th { background-color: var(--esc-blue); color: white; }
        .bg-elevated { background-color: #fff3cd; }
        .bg-htn { background-color: #f8d7da; }
    </style>
</head>
<body>

    <header class="header-main text-center">
        <div class="container">
            <h1><i class="fa-solid fa-heart-pulse"></i> Manejo de la HTA - Guía ESC 2024</h1>
            <p class="lead">Herramienta de soporte a la decisión clínica y cálculo de riesgo</p>
            <small class="text-white-50">Uso exclusivo para profesionales de la salud. Datos basados en ESC Guidelines 2024.</small>
        </div>
    </header>

    <div class="container">
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="sticky-top" style="top: 20px; z-index: 100;">
                    <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                        <button class="nav-link active text-start" data-bs-toggle="pill" data-bs-target="#fisio" type="button"><i class="fa-solid fa-brain me-2"></i> Fisiopatología & Clínica</button>
                        <button class="nav-link text-start" data-bs-toggle="pill" data-bs-target="#dx" type="button"><i class="fa-solid fa-stethoscope me-2"></i> Diagnóstico & Clasificación</button>
                        <button class="nav-link text-start" data-bs-toggle="pill" data-bs-target="#calc" type="button"><i class="fa-solid fa-calculator me-2"></i> Calc. Riesgo (ASCVD)</button>
                        <button class="nav-link text-start" data-bs-toggle="pill" data-bs-target="#tx" type="button"><i class="fa-solid fa-pills me-2"></i> Tratamiento</button>
                        <button class="nav-link text-start" data-bs-toggle="pill" data-bs-target="#resis" type="button"><i class="fa-solid fa-shield-virus me-2"></i> HTA Resistente</button>
                        <button class="nav-link text-start" data-bs-toggle="pill" data-bs-target="#special" type="button"><i class="fa-solid fa-hospital-user me-2"></i> Situaciones Especiales</button>
                    </div>
                </div>
            </div>

            <div class="col-md-9">
                <div class="tab-content" id="v-pills-tabContent">

                    <div class="tab-pane fade show active" id="fisio" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Fisiopatología Resumida (ESC 2024)</div>
                            <div class="card-body">
                                <p>La hipertensión es el resultado de una interacción compleja entre factores genéticos, ambientales y sistemas reguladores:</p>
                                <ul>
                                    <li><strong>Sistema Nervioso Simpático:</strong> Hiperactividad en fases tempranas y en HTA resistente.</li>
                                    <li><strong>Sistema Renina-Angiotensina-Aldosterona (SRAA):</strong> Clave en la retención de sodio y vasoconstricción.</li>
                                    <li><strong>Disfunción Endotelial:</strong> Rigidez arterial y aumento de resistencias periféricas.</li>
                                    <li><strong>Daño Orgánico (HMOD):</strong> La elevación persistente causa daño subclínico en corazón (HVI), riñón (albuminuria), vasos (rigidez) y retina antes de los eventos cardiovasculares.</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="dx" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Nueva Clasificación ESC 2024</div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <strong>Cambio Clave 2024:</strong> Se introduce la categoría <strong>"PA Elevada"</strong>. La HTA sigue siendo ≥140/90 mmHg en consulta.
                                </div>
                                <table class="table table-bordered table-bp text-center">
                                    <thead>
                                        <tr>
                                            <th>Categoría</th>
                                            <th>Sistólica (mmHg)</th>
                                            <th>Diastólica (mmHg)</th>
                                            <th>Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>No elevada</td>
                                            <td>&lt; 120</td>
                                            <td>&lt; 70</td>
                                            <td>Estilo de vida saludable</td>
                                        </tr>
                                        <tr class="bg-elevated">
                                            <td><strong>PA Elevada</strong></td>
                                            <td><strong>120 - 139</strong></td>
                                            <td><strong>70 - 89</strong></td>
                                            <td>Evaluar Riesgo CV. Tratar si Riesgo Alto.</td>
                                        </tr>
                                        <tr class="bg-htn">
                                            <td><strong>Hipertensión</strong></td>
                                            <td><strong>&ge; 140</strong></td>
                                            <td><strong>&ge; 90</strong></td>
                                            <td>Tratamiento Farmacológico + Estilo de vida</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p class="mt-3"><strong>Confirmación Diagnóstica:</strong></p>
                                <ul>
                                    <li>Se recomienda AMPA (Domicilio) o MAPA (Ambulatoria 24h) para confirmar, especialmente en "PA Elevada" o sospecha de bata blanca.</li>
                                    <li><strong>Umbral HTA Domicilio (AMPA):</strong> &ge; 135/85 mmHg.</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="calc" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Calculadora de Riesgo ASCVD (10 años)</div>
                            <div class="card-body">
                                <div class="alert alert-warning py-2">
                                    <small><i class="fa-solid fa-triangle-exclamation"></i> Nota: La ESC recomienda <strong>SCORE2</strong> para Europa. Esta calculadora usa las ecuaciones ASCVD (ACC/AHA) como solicitado. Útil para estimar riesgo en contextos no europeos o por preferencia clínica.</small>
                                </div>
                                <form id="ascvdForm">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Edad (20-79)</label>
                                            <input type="number" class="form-control" id="age" min="20" max="79" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Sexo</label>
                                            <select class="form-select" id="sex">
                                                <option value="male">Hombre</option>
                                                <option value="female">Mujer</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Raza (Algoritmo ASCVD)</label>
                                            <select class="form-select" id="race">
                                                <option value="white">Blanca / Otros</option>
                                                <option value="aa">Afroamericano</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">PA Sistólica (mmHg)</label>
                                            <input type="number" class="form-control" id="sbp" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Colesterol Total (mg/dL)</label>
                                            <input type="number" class="form-control" id="tc" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Colesterol HDL (mg/dL)</label>
                                            <input type="number" class="form-control" id="hdl" required>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="diabetes">
                                                <label class="form-check-label">Diabetes</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="smoker">
                                                <label class="form-check-label">Fumador Actual</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check mt-4">
                                                <input class="form-check-input" type="checkbox" id="treatment">
                                                <label class="form-check-label">Tx Hipertensivo</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-grid gap-2 mt-4">
                                        <button type="button" class="btn btn-primary" onclick="calculateASCVD()">Calcular Riesgo</button>
                                    </div>
                                </form>

                                <div id="resultBox" class="target-box mt-4 d-none text-center">
                                    <p class="mb-0">Riesgo de Evento CV a 10 años:</p>
                                    <div class="calc-result" id="riskResult">--%</div>
                                    <p id="riskCategory" class="fw-bold"></p>
                                    <p class="small text-muted mt-2">Si el riesgo es ≥10% y hay PA Elevada (120-139), la ESC 2024 recomienda iniciar tratamiento farmacológico tras 3 meses de estilo de vida (o inmediato si ≥140/90).</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="tx" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Estrategia Terapéutica ESC 2024</div>
                            <div class="card-body">
                                <div class="target-box">
                                    <h5><i class="fa-solid fa-bullseye"></i> Objetivo de PA</h5>
                                    <p class="mb-0"><strong>120 - 129 / 70 - 79 mmHg</strong> para la mayoría de los pacientes (si se tolera).</p>
                                    <small>En ancianos frágiles o sintomáticos: "Tan bajo como sea razonablemente posible".</small>
                                </div>

                                <h5 class="mt-4">Algoritmo General</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        <strong>Inicio:</strong> Cambios en Estilo de Vida (Restricción de Na+, Potasio si no hay ERC avanzada, Ejercicio).
                                    </li>
                                    <li class="list-group-item list-group-item-action">
                                        <span class="badge bg-primary rounded-pill">Paso 1</span>
                                        <strong>Terapia Dual (Combinación en una sola pastilla - SPC):</strong>
                                        <br>IECA o ARA-II + Calcioantagonista (CCB) o Diurético Tiazídico/Símil.
                                        <br><small class="text-muted">*Monoterapia solo en: PA Elevada bajo riesgo, fragilidad grave o muy ancianos.</small>
                                    </li>
                                    <li class="list-group-item list-group-item-action">
                                        <span class="badge bg-primary rounded-pill">Paso 2</span>
                                        <strong>Terapia Triple (SPC):</strong>
                                        <br>IECA o ARA-II + CCB + Diurético Tiazídico/Símil.
                                    </li>
                                    <li class="list-group-item list-group-item-action">
                                        <span class="badge bg-danger rounded-pill">Paso 3</span>
                                        <strong>HTA Resistente:</strong>
                                        <br>Añadir Espironolactona (o eplerenona/amilorida). Considerar Beta-bloqueante o Alfa-bloqueante.
                                    </li>
                                </ul>
                                <div class="mt-3">
                                    <strong>Beta-bloqueantes:</strong> Considerar en cualquier paso si hay insuficiencia cardíaca, angina, post-IAM o control de frecuencia en FA.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="resis" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Hipertensión Resistente</div>
                            <div class="card-body">
                                <p><strong>Definición:</strong> PA no controlada a pesar de 3 fármacos (incluyendo un diurético) a dosis máximas toleradas, o controlada con 4 fármacos.</p>
                                
                                <h6>Manejo Paso a Paso:</h6>
                                <ol>
                                    <li><strong>Descartar Pseudorresistencia:</strong> Mala adherencia (causa #1), efecto bata blanca (usar MAPA), técnica inadecuada.</li>
                                    <li><strong>Optimizar Diurético:</strong> Usar Clortalidona o Indapamida en lugar de Hidroclorotiazida si es posible.</li>
                                    <li><strong>Añadir 4º Fármaco:</strong> 
                                        <br> - <strong>Espironolactona</strong> (25-50mg) es la elección (si K+ < 4.5 y TFGe > 45).
                                        <br> - Alternativas: Eplerenona, Doxazosina, Bisoprolol.
                                    </li>
                                    <li><strong>Denervación Renal:</strong> La guía 2024 sube la recomendación a Clase IIb (se puede considerar) en centros especializados si el paciente lo prefiere y hay resistencia verdadera.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="special" role="tabpanel">
                        <div class="card">
                            <div class="card-header">Condiciones Especiales</div>
                            <div class="card-body">
                                <div class="accordion" id="accordionSpecial">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#colPreg">
                                                Embarazo
                                            </button>
                                        </h2>
                                        <div id="colPreg" class="accordion-collapse collapse show" data-bs-parent="#accordionSpecial">
                                            <div class="accordion-body">
                                                <p><strong>Tratar si:</strong> PA &ge; 140/90 mmHg.</p>
                                                <p><strong>Fármacos Seguros:</strong> Labetalol, Metildopa, Nifedipino.</p>
                                                <p class="text-danger"><strong>CONTRAINDICADOS:</strong> IECAs, ARA-II, Inhibidores directos de renina (Aliskiren).</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#colCKD">
                                                Enfermedad Renal Crónica (ERC)
                                            </button>
                                        </h2>
                                        <div id="colCKD" class="accordion-collapse collapse" data-bs-parent="#accordionSpecial">
                                            <div class="accordion-body">
                                                <p><strong>Objetivo:</strong> 120-129 sistólica si se tolera.</p>
                                                <p><strong>Fármacos:</strong> IECA o ARA-II son primera línea (reducen albuminuria). Combinar con CCB o Diurético.</p>
                                                <p><strong>Novedad:</strong> Uso de iSGLT2 y Finerenona por beneficio cardio-renal.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#colOld">
                                                Ancianos / Fragilidad
                                            </button>
                                        </h2>
                                        <div id="colOld" class="accordion-collapse collapse" data-bs-parent="#accordionSpecial">
                                            <div class="accordion-body">
                                                <p><strong>Fit/Robustos:</strong> Tratar igual que a jóvenes (Objetivo 120-129).</p>
                                                <p><strong>Frágiles / >85 años:</strong> Iniciar con monoterapia. Objetivo "tan bajo como sea razonablemente posible" sin causar hipotensión ortostática o caídas. Evitar <120 mmHg.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <footer class="text-center py-4 mt-5" style="background-color: white; border-top: 1px solid #eee;">
        <div class="container">
            <p class="text-muted small">Desarrollado para uso educativo basado en las guías ESC 2024.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function calculateASCVD() {
            // Obtener valores
            const age = parseFloat(document.getElementById('age').value);
            const sex = document.getElementById('sex').value; // male, female
            const race = document.getElementById('race').value; // white, aa
            const sbp = parseFloat(document.getElementById('sbp').value);
            const tc = parseFloat(document.getElementById('tc').value);
            const hdl = parseFloat(document.getElementById('hdl').value);
            const diabetes = document.getElementById('diabetes').checked;
            const smoker = document.getElementById('smoker').checked;
            const treatment = document.getElementById('treatment').checked;

            // Validaciones simples
            if(!age || !sbp || !tc || !hdl) {
                alert("Por favor complete todos los campos numéricos.");
                return;
            }
            if (age < 20 || age > 79) {
                alert("Esta calculadora está validada para edades entre 20 y 79 años.");
                return;
            }

            // Coeficientes (Pooled Cohort Equations 2013)
            // Nota: Esto es una implementación simplificada de la lógica estándar.
            // Estructura: [Age, Sq_Age, TC, Age_TC, HDL, Age_HDL, Trt_SBP, Age_Trt_SBP, Untrt_SBP, Age_Untrt_SBP, Smoke, Age_Smoke, Diab]
            
            let coeffs = {};
            let baseline = 0; // Mean terms
            
            // Seleccionar coeficientes según Sexo y Raza
            if (race === 'white' && sex === 'female') {
                coeffs = { lnAge: -29.799, lnAgeSq: 4.884, lnTotChol: 13.54, lnAgeTotChol: -3.114, lnHdl: -13.578, lnAgeHdl: 3.149, lnTrtSbp: 2.019, lnAgeTrtSbp: 0, lnUntrtSbp: 1.957, lnAgeUntrtSbp: 0, smoker: 7.574, lnAgeSmoker: -1.665, diabetes: 0.661 };
                baseline = 0.9665; // S10
                meanTerms = -29.18;
            } else if (race === 'aa' && sex === 'female') {
                coeffs = { lnAge: 17.114, lnAgeSq: 0, lnTotChol: 0.94, lnAgeTotChol: 0, lnHdl: -18.92, lnAgeHdl: 4.475, lnTrtSbp: 29.291, lnAgeTrtSbp: -6.432, lnUntrtSbp: 27.82, lnAgeUntrtSbp: -6.087, smoker: 0.691, lnAgeSmoker: 0, diabetes: 0.874 };
                baseline = 0.9533;
                meanTerms = 86.61;
            } else if (race === 'white' && sex === 'male') {
                coeffs = { lnAge: 12.344, lnAgeSq: 0, lnTotChol: 11.853, lnAgeTotChol: -2.664, lnHdl: -7.99, lnAgeHdl: 1.769, lnTrtSbp: 1.797, lnAgeTrtSbp: 0, lnUntrtSbp: 1.764, lnAgeUntrtSbp: 0, smoker: 7.837, lnAgeSmoker: -1.795, diabetes: 0.658 };
                baseline = 0.9144;
                meanTerms = 61.18;
            } else { // aa male
                coeffs = { lnAge: 2.469, lnAgeSq: 0, lnTotChol: 0.302, lnAgeTotChol: 0, lnHdl: -0.307, lnAgeHdl: 0, lnTrtSbp: 1.916, lnAgeTrtSbp: 0, lnUntrtSbp: 1.809, lnAgeUntrtSbp: 0, smoker: 0.549, lnAgeSmoker: 0, diabetes: 0.645 };
                baseline = 0.8954;
                meanTerms = 19.54;
            }

            // Logaritmos naturales
            const lnAge = Math.log(age);
            const lnTotChol = Math.log(tc);
            const lnHdl = Math.log(hdl);
            const lnSbp = Math.log(sbp);

            // Calcular suma
            let sum = (coeffs.lnAge * lnAge) + 
                      (coeffs.lnAgeSq * Math.pow(lnAge, 2)) + 
                      (coeffs.lnTotChol * lnTotChol) + 
                      (coeffs.lnAgeTotChol * lnAge * lnTotChol) + 
                      (coeffs.lnHdl * lnHdl) + 
                      (coeffs.lnAgeHdl * lnAge * lnHdl) +
                      (diabetes ? coeffs.diabetes : 0);

            // Tratamiento HTA
            if (treatment) {
                sum += (coeffs.lnTrtSbp * lnSbp) + (coeffs.lnAgeTrtSbp * lnAge * lnSbp);
            } else {
                sum += (coeffs.lnUntrtSbp * lnSbp) + (coeffs.lnAgeUntrtSbp * lnAge * lnSbp);
            }

            // Fumador
            if (smoker) {
                sum += coeffs.smoker + (coeffs.lnAgeSmoker * lnAge);
            }

            // Cálculo final
            const riskValue = 1 - Math.pow(baseline, Math.exp(sum - meanTerms));
            const percentage = (riskValue * 100).toFixed(1);

            // Mostrar resultado
            const resultBox = document.getElementById('resultBox');
            const riskText = document.getElementById('riskResult');
            const catText = document.getElementById('riskCategory');

            resultBox.classList.remove('d-none');
            riskText.innerHTML = percentage + "%";

            // Categorización ESC 2024 para tratamiento (Simplificada)
            if (percentage >= 10) {
                catText.innerHTML = "<span class='text-danger'>RIESGO ALTO (Equivalente a SCORE2 Alto)</span>";
                catText.className = "fw-bold text-danger";
            } else if (percentage >= 5) {
                catText.innerHTML = "<span class='text-warning'>RIESGO MODERADO/LIMÍTROFE</span>";
                catText.className = "fw-bold text-warning";
            } else {
                catText.innerHTML = "<span class='text-success'>RIESGO BAJO</span>";
                catText.className = "fw-bold text-success";
            }
        }
    </script>
</body>
</html>